[tox]
envlist=py3{6,7,8,9,10,11}
isolated_build = true

[testenv]
skip_install = true
setenv = 
    PG_HOST=localhost
    PG_NAME=automated_test
    PG_USER=gdc_test
    PG_PASS=gdc_test
    PG_ADMIN_USER=postgres
    PG_ADMIN_PASS=postgres
allowlist_externals = 
    bash
    poetry
commands_pre = 
    poetry install --with=test
commands =
    coverage run --source gdc_ng_models -m pytest -lv --junit-xml test-reports/results.xml {posargs}
    coverage report
    coverage html
    coverage xml
